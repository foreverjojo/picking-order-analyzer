<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ©˜é»å­æ’¿è²¨å–®åˆ†æ - è‡ªå‹•æ˜ å°„æ¸¬è©¦</title>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <style>
        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft JhengHei', sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        h1 {
            color: #FF6B00;
        }

        .upload-box {
            border: 2px dashed #FF6B00;
            padding: 40px;
            text-align: center;
            background: white;
            border-radius: 8px;
            margin-bottom: 20px;
            cursor: pointer;
        }

        .upload-box:hover {
            background: #fff5ee;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            margin-top: 20px;
        }

        th,
        td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
            font-size: 12px;
        }

        th {
            background: #FF6B00;
            color: white;
            position: sticky;
            top: 0;
        }

        tr:nth-child(even) {
            background: #f9f9f9;
        }

        .stats {
            background: #e7f3ff;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .success {
            color: #28a745;
        }

        .warning {
            color: #ffc107;
        }

        .error {
            color: #dc3545;
        }

        .filtered {
            color: #6c757d;
            font-style: italic;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>ğŸŠ æ©˜é»å­æ’¿è²¨å–® - è‡ªå‹•æ˜ å°„æ¸¬è©¦</h1>

        <div class="upload-box" onclick="document.getElementById('fileInput').click()">
            <p>ğŸ“ æ‹–æ›³æˆ–é»æ“Šä¸Šå‚³æ©˜é»å­æ’¿è²¨å–® Excel æª”æ¡ˆ</p>
            <input type="file" id="fileInput" accept=".xls,.xlsx" style="display:none;">
        </div>

        <div id="stats" class="stats" style="display:none;"></div>

        <div id="result" style="display:none;">
            <h3>ğŸ“¦ è§£æçµæœ</h3>
            <table>
                <thead>
                    <tr>
                        <th>#</th>
                        <th>åŸå§‹è³‡æ–™</th>
                        <th>å•†å“åç¨±</th>
                        <th>æ•¸é‡</th>
                        <th>å ±è¡¨å•†å“</th>
                        <th>æ¬„ä½</th>
                        <th>è¦æ ¼</th>
                        <th>å°æ‡‰æ•¸é‡</th>
                        <th>ä¿¡å¿ƒåº¦</th>
                    </tr>
                </thead>
                <tbody id="dataBody"></tbody>
            </table>
        </div>
    </div>

    <script>
        // æ¨™æº–å ±è¡¨å•†å“åç¨±åˆ—è¡¨
        const standardProductNames = [
            'è±†å¡”-è”“è¶Šè“', 'è±†å¡”-ç„¦ç³–', 'è±†å¡”-å·§å…‹åŠ›', 'è±†å¡”-æŠ¹èŒ¶', 'è±†å¡”-æ¤’éº»',
            'å …æœå¡”-èœ‚èœœ', 'å …æœå¡”-ç„¦ç³–', 'å …æœå¡”-å·§å…‹åŠ›', 'å …æœå¡”-æµ·è‹”', 'å …æœå¡”-å’–å“©',
            'è±†å¡”-ç¶œåˆ', 'å …æœå¡”-ç¶œåˆ', 'é›™å¡”',
            'åœŸé³³æ¢¨é…¥(ç´…é»)', 'é³³å‡°é…¥',
            'é›ªèŠ±é¤…-ç¶œåˆ', 'é›ªèŠ±é¤…-è”“è¶Šè“', 'é›ªèŠ±é¤…-å·§å…‹åŠ›', 'é›ªèŠ±é¤…-é‡‘æ²™', 'é›ªèŠ±é¤…-æŠ¹èŒ¶', 'é›ªèŠ±é¤…-è‚‰é¬†',
            'ç‘ªå¾·è“®-ç¶œåˆ', 'ç‘ªå¾·è“®-èœ‚èœœ', 'ç‘ªå¾·è“®-å·§å…‹åŠ›', 'ç‘ªå¾·è“®-ç´…èŒ¶', 'ç‘ªå¾·è“®-æŠ¹èŒ¶', 'ç‘ªå¾·è“®-æŸ‘æ©˜', 'ç‘ªå¾·è“®-æª¸æª¬',
            'ç„¡èª¿å‘³ç¶œåˆå …æœ', 'ç„¡èª¿å‘³å¤å¨å¤·è±†', 'ç„¡èª¿å‘³è…°æœ', 'ç„¡èª¿å‘³æä»', 'ç„¡èª¿å‘³æ ¸æ¡ƒ',
            'â˜…ä¸­æ±æ¤°æ£—300g', 'æ¤°æ£—è±†å­150g', 'æ¤°æ£—è…°æœ150g', 'æ¤°æ£—æä»150g', 'æ¤°æ£—æ ¸æ¡ƒ150g',
            'ç‰›å¥¶ç³–', 'å—æ£—æ ¸æ¡ƒç³•', 'ç‰›å¥¶ç³–-50g',
            'ç“¦ç‰‡-ç¶œåˆ', 'ç“¦ç‰‡-åŸå‘³', 'ç“¦ç‰‡-ç´…èŒ¶', 'ç“¦ç‰‡-å·§å…‹åŠ›', 'ç“¦ç‰‡-æµ·è‹”', 'ç“¦ç‰‡-æŠ¹èŒ¶', 'ç“¦ç‰‡-é»‘ç³–', 'ç“¦ç‰‡-é’èŠ±æ¤’', 'ç“¦ç‰‡-åŸå‘³45å…‹',
            'å¥¶æ²¹-ç„¦ç³–ç‰›å¥¶', 'å¥¶æ²¹-æ³•åœ‹å·§å…‹åŠ›', 'å¥¶æ²¹-èœ‚èœœæª¸æª¬', 'å¥¶æ²¹-ä¼¯çˆµç´…èŒ¶', 'å¥¶æ²¹-æŠ¹èŒ¶',
            'åƒå±¤å°é…¥æ¢-åŸå‘³', 'è¥¿é»-ç¶œåˆ', 'è¥¿é»-å·§å…‹åŠ›è²æ®¼', 'è¥¿é»-å’–å•¡å°èŠ±', 'è¥¿é»-è—è“å°èŠ±', 'è¥¿é»-è”“è¶Šè“è²æ®¼', 'è¥¿é»-ä¹³é…ªé…¥æ¢',
            'é›™å¡”ç¦®ç›’', 'è”“è¶Šè“ç¦®ç›’', 'ç¶œè±†ç¦®ç›’', 'ç¶œå …ç¦®ç›’', 'æ™´ç©ºå¡”é¤…ç¦®ç›’', 'æš–æš–å¹¸ç¦ç¦®ç›’', 'è‡»æ„›æ™‚å…‰ç¦®ç›’', 'æ¿ƒæƒ…æ»¿è¼‰ç¦®ç›’',
            'æµªæ¼«è©©ç¯‡ç¦®ç›’', 'æˆ€æˆ€é›ªèŠ±ç¦®ç›’', 'åˆå¾Œæ¼«æ­¥ç¦®ç›’', 'é‚£å¹´èŠ±é–‹ç¦®ç›’', 'èŠ±é–“é€¸éŸ»ç¦®ç›’',
            'è¼•-é¦™æ¦­æ¼«éŠç¦®ç›’', 'è¼•-æ™¨æ›¦ç‰©èªç¦®ç›’', 'è¼•-é‡‘ç·»å…¸è—ç¦®ç›’', 'è¼•-æœˆå…‰åºæ›²ç¦®ç›’'
        ];

        // è§£ææ©˜é»å­æ ¼å¼ï¼šè¿”å›å•†å“æ•¸çµ„
        function parseOrangePointCell(cellValue) {
            if (!cellValue || typeof cellValue !== 'string') return [];

            const text = cellValue.trim();
            if (!text) return [];

            const results = [];

            // éæ¿¾å’–å•¡ï¼ˆé™¤äº†å’–å•¡å°èŠ±ï¼‰
            if (text.includes('å’–å•¡') && !text.includes('å’–å•¡å°èŠ±')) {
                return [];
            }

            // è™•ç†è´ˆå“æ ¼å¼ï¼šè´ˆå“:æ»¿é¡è´ˆ#è‰¾è–‡-æä»ç“¦ç‰‡(åŸå‘³)135g 1 æˆ– x 1 æˆ– x1
            if (text.startsWith('è´ˆå“:')) {
                // æå– # å¾Œé¢çš„å•†å“åç¨±å’Œæœ€å¾Œçš„æ•¸é‡ï¼ˆæ”¯æ´ x 1, x1, æˆ–ç›´æ¥æ•¸å­—ï¼‰
                const giftMatch = text.match(/[#](.+?)\s*[xÃ—]?\s*(\d+)$/i);
                if (giftMatch) {
                    const quantity = parseInt(giftMatch[2]);
                    // éæ¿¾æ•¸é‡ç‚º 0 çš„é …ç›®
                    if (quantity === 0) return [];

                    results.push({
                        name: giftMatch[1].trim(),
                        quantity: quantity,
                        type: 'è´ˆå“'
                    });
                }
                return results;
            }

            // è™•ç†è©¦åƒæ ¼å¼ï¼šè©¦åƒ:è‰¾è–‡-æä»ç“¦ç‰‡(åŸå‘³)135g*1+è‰¾è–‡-æä»ç“¦ç‰‡(å·§å…‹åŠ›)90g*1 79
            if (text.startsWith('è©¦åƒ:')) {
                // æå–æœ€å¾Œçš„ç¸½æ•¸é‡
                const quantityMatch = text.match(/\s+(\d+)$/);
                if (!quantityMatch) return [];
                const totalQuantity = parseInt(quantityMatch[1]);

                // éæ¿¾æ•¸é‡ç‚º 0 çš„é …ç›®
                if (totalQuantity === 0) return [];

                // æå–å•†å“åˆ—è¡¨éƒ¨åˆ†ï¼ˆç§»é™¤ "è©¦åƒ:" å’Œæœ€å¾Œçš„æ•¸é‡ï¼‰
                const productPart = text.replace(/^è©¦åƒ:/, '').replace(/\s+\d+$/, '').trim();

                // åˆ†å‰²å•†å“ï¼ˆä»¥ + åˆ†éš”ï¼‰
                const productItems = productPart.split('+');
                for (const item of productItems) {
                    // ç§»é™¤ *N éƒ¨åˆ†ï¼Œåªä¿ç•™å•†å“åç¨±
                    const cleanName = item.replace(/\*\d+$/, '').trim();
                    if (cleanName) {
                        results.push({
                            name: cleanName,
                            quantity: totalQuantity,
                            type: 'è©¦åƒ'
                        });
                    }
                }
                return results;
            }

            // æ™®é€šæ ¼å¼ï¼šå•†å“åç¨± æ•¸é‡
            const match = text.match(/^(.+?)\s+(\d+)$/);
            if (match) {
                const name = match[1].trim();
                const quantity = parseInt(match[2]);

                // éæ¿¾ Total è¡Œå’Œæ•¸é‡ç‚º 0 çš„é …ç›®
                if (name.toLowerCase() === 'total' || quantity === 0) {
                    return [];
                }

                results.push({
                    name: name,
                    quantity: quantity
                });
            }

            return results;
        }

        // æ¨™æº–åŒ–å•†å“åç¨±
        function normalizeProductName(name) {
            if (!name) return null;
            const cleaned = name.replace(/\s+/g, '');

            // ç²¾ç¢ºåŒ¹é…
            for (let stdName of standardProductNames) {
                if (cleaned === stdName.replace(/\s+/g, '')) return stdName;
            }

            // æœ€é•·åŒ¹é…
            let bestMatch = null;
            let bestMatchLength = 0;
            for (let stdName of standardProductNames) {
                const stdCleaned = stdName.replace(/\s+/g, '');
                if (cleaned.includes(stdCleaned) && stdCleaned.length > bestMatchLength) {
                    bestMatch = stdName;
                    bestMatchLength = stdCleaned.length;
                }
            }

            return bestMatch || name;
        }

        // æ©˜é»å­å°ˆç”¨æ˜ å°„å‡½æ•¸
        function autoMapProductOrangePoint(productName, quantity) {
            const nameNoSpace = productName.replace(/\s+/g, '');

            let mappedName = null;
            let column = null;
            let spec = null;
            let confidence = 0.3;

            // === ç“¦ç‰‡ ===
            if (/æä»ç“¦ç‰‡/.test(nameNoSpace)) {
                // æå–å£å‘³ [åŸå‘³] æˆ– (åŸå‘³) æ ¼å¼
                const flavorMatch = productName.match(/[\[\(](.+?)[\]\)]/) || productName.match(/ç“¦ç‰‡[-]?(.+?)(?:\d+g|$)/);
                let flavor = '';
                if (flavorMatch) {
                    flavor = flavorMatch[1].trim();
                }
                if (flavor === 'åŸå‘³' || /åŸå‘³/.test(nameNoSpace)) mappedName = 'ç“¦ç‰‡-åŸå‘³';
                else if (flavor === 'å·§å…‹åŠ›' || /å·§å…‹åŠ›/.test(nameNoSpace)) mappedName = 'ç“¦ç‰‡-å·§å…‹åŠ›';
                else if (flavor === 'ç´…èŒ¶' || /ç´…èŒ¶/.test(nameNoSpace)) mappedName = 'ç“¦ç‰‡-ç´…èŒ¶';
                else if (flavor === 'é»‘ç³–' || /é»‘ç³–/.test(nameNoSpace)) mappedName = 'ç“¦ç‰‡-é»‘ç³–';
                else if (flavor === 'æŠ¹èŒ¶' || /æŠ¹èŒ¶/.test(nameNoSpace)) mappedName = 'ç“¦ç‰‡-æŠ¹èŒ¶';
                else if (flavor === 'æµ·è‹”' || /æµ·è‹”/.test(nameNoSpace)) mappedName = 'ç“¦ç‰‡-æµ·è‹”';
                else if (flavor === 'é’èŠ±æ¤’' || /é’èŠ±æ¤’/.test(nameNoSpace)) mappedName = 'ç“¦ç‰‡-é’èŠ±æ¤’';
                else if (/ç¶œåˆ/.test(flavor) || /ç¶œåˆ/.test(nameNoSpace)) mappedName = 'ç“¦ç‰‡-ç¶œåˆ';
                confidence = 0.95;

                // è¦æ ¼
                if (/135g/.test(nameNoSpace)) { column = 'C'; spec = '135g'; }
                else if (/90g/.test(nameNoSpace)) { column = 'B'; spec = '90g'; }
                else if (/45g/.test(nameNoSpace)) { column = 'B'; spec = '45g'; }
            }

            // === å¤å¨å¤·è±†å¡” ===
            if (!mappedName && /å¤å¨å¤·è±†å¡”/.test(nameNoSpace)) {
                const flavorMatch = productName.match(/\[(.+?)\]/);
                if (flavorMatch) {
                    const flavor = flavorMatch[1];
                    if (flavor.includes('è”“è¶Šè“')) mappedName = 'è±†å¡”-è”“è¶Šè“';
                    else if (flavor.includes('ç„¦ç³–')) mappedName = 'è±†å¡”-ç„¦ç³–';
                    else if (flavor.includes('å·§å…‹åŠ›')) mappedName = 'è±†å¡”-å·§å…‹åŠ›';
                    else if (flavor.includes('æŠ¹èŒ¶')) mappedName = 'è±†å¡”-æŠ¹èŒ¶';
                    else if (flavor.includes('æ¤’éº»')) mappedName = 'è±†å¡”-æ¤’éº»';
                    else if (flavor.includes('ç¶œåˆ')) mappedName = 'è±†å¡”-ç¶œåˆ';
                }
                confidence = 0.95;

                if (/10å…¥/.test(nameNoSpace)) { column = 'B'; spec = '10å…¥è¢‹è£'; }
                else if (/15å…¥/.test(nameNoSpace)) { column = 'C'; spec = '15å…¥è¢‹è£'; }
            }

            // === å …æœå¡” ===
            if (!mappedName && /å …æœå¡”|ç¶œåˆå …æœå¡”/.test(nameNoSpace)) {
                const flavorMatch = productName.match(/\[(.+?)\]/);
                if (flavorMatch) {
                    const flavor = flavorMatch[1];
                    if (flavor.includes('èœ‚èœœ')) mappedName = 'å …æœå¡”-èœ‚èœœ';
                    else if (flavor.includes('ç„¦ç³–')) mappedName = 'å …æœå¡”-ç„¦ç³–';
                    else if (flavor.includes('å·§å…‹åŠ›')) mappedName = 'å …æœå¡”-å·§å…‹åŠ›';
                    else if (flavor.includes('æµ·è‹”')) mappedName = 'å …æœå¡”-æµ·è‹”';
                    else if (flavor.includes('å’–å“©')) mappedName = 'å …æœå¡”-å’–å“©';
                    else if (flavor.includes('ç¶œåˆ')) mappedName = 'å …æœå¡”-ç¶œåˆ';
                }
                confidence = 0.95;

                if (/10å…¥/.test(nameNoSpace)) { column = 'B'; spec = '10å…¥è¢‹è£'; }
                else if (/15å…¥/.test(nameNoSpace)) { column = 'C'; spec = '15å…¥è¢‹è£'; }
            }

            // === é›ªèŠ±é¤… ===
            if (!mappedName && /é›ªèŠ±é¤…/.test(nameNoSpace)) {
                const flavorMatch = productName.match(/\[(.+?)\]/);
                if (flavorMatch) {
                    const flavor = flavorMatch[1];
                    if (flavor.includes('è”“è¶Šè“')) mappedName = 'é›ªèŠ±é¤…-è”“è¶Šè“';
                    else if (flavor.includes('å·§å…‹åŠ›')) mappedName = 'é›ªèŠ±é¤…-å·§å…‹åŠ›';
                    else if (flavor.includes('é‡‘æ²™')) mappedName = 'é›ªèŠ±é¤…-é‡‘æ²™';
                    else if (flavor.includes('æŠ¹èŒ¶')) mappedName = 'é›ªèŠ±é¤…-æŠ¹èŒ¶';
                    else if (flavor.includes('è‚‰é¬†')) mappedName = 'é›ªèŠ±é¤…-è‚‰é¬†';
                    else if (flavor.includes('ç¶œåˆ')) mappedName = 'é›ªèŠ±é¤…-ç¶œåˆ';
                }
                confidence = 0.95;

                if (/10å…¥/.test(nameNoSpace)) { column = 'B'; spec = '10å…¥è¢‹è£'; }
                else if (/15å…¥/.test(nameNoSpace)) { column = 'C'; spec = '15å…¥è¢‹è£'; }
            }

            // === ç‘ªå¾·è“® ===
            if (!mappedName && /ç‘ªå¾·è“®/.test(nameNoSpace)) {
                const flavorMatch = productName.match(/\[(.+?)\]/);
                if (flavorMatch) {
                    const flavor = flavorMatch[1];
                    if (flavor.includes('èœ‚èœœ')) mappedName = 'ç‘ªå¾·è“®-èœ‚èœœ';
                    else if (flavor.includes('å·§å…‹åŠ›')) mappedName = 'ç‘ªå¾·è“®-å·§å…‹åŠ›';
                    else if (flavor.includes('ç´…èŒ¶')) mappedName = 'ç‘ªå¾·è“®-ç´…èŒ¶';
                    else if (flavor.includes('æŠ¹èŒ¶')) mappedName = 'ç‘ªå¾·è“®-æŠ¹èŒ¶';
                    else if (flavor.includes('æŸ‘æ©˜')) mappedName = 'ç‘ªå¾·è“®-æŸ‘æ©˜';
                    else if (flavor.includes('æª¸æª¬')) mappedName = 'ç‘ªå¾·è“®-æª¸æª¬';
                    else if (flavor.includes('ç¶œåˆ')) mappedName = 'ç‘ªå¾·è“®-ç¶œåˆ';
                }
                confidence = 0.95;
            }

            // === ç¦®ç›’ ===
            if (!mappedName && /ç¦®ç›’/.test(nameNoSpace)) {
                column = 'B'; spec = 'ç¦®ç›’'; confidence = 0.95;
                if (/é›™å¡”ç¦®ç›’|æ‹›ç‰Œé›™å¡”/.test(nameNoSpace)) mappedName = 'é›™å¡”ç¦®ç›’';
                else if (/æˆ€æˆ€é›ªèŠ±/.test(nameNoSpace)) mappedName = 'æˆ€æˆ€é›ªèŠ±ç¦®ç›’';
                else if (/æµªæ¼«è©©ç¯‡/.test(nameNoSpace)) mappedName = 'æµªæ¼«è©©ç¯‡ç¦®ç›’';
                else if (/æš–æš–å¹¸ç¦/.test(nameNoSpace)) mappedName = 'æš–æš–å¹¸ç¦ç¦®ç›’';
                else if (/è‡»æ„›æ™‚å…‰/.test(nameNoSpace)) mappedName = 'è‡»æ„›æ™‚å…‰ç¦®ç›’';
            }

            // æ¨™æº–åŒ–åç¨±
            const standardizedName = mappedName ? normalizeProductName(mappedName) : null;
            const mappedQuantity = column ? quantity : 0;

            return {
                templateProduct: standardizedName,
                templateColumn: column,
                templateSpec: spec,
                multiplier: 1,
                mappedQuantity: mappedQuantity,
                confidence: mappedName ? confidence : 0.3
            };
        }

        document.getElementById('fileInput').addEventListener('change', async (e) => {
            const file = e.target.files[0];
            if (!file) return;

            const arrayBuffer = await file.arrayBuffer();
            const workbook = XLSX.read(arrayBuffer, { type: 'array' });
            const worksheet = workbook.Sheets[workbook.SheetNames[0]];
            const data = XLSX.utils.sheet_to_json(worksheet, { header: 1, defval: '' });

            // è§£ææ‰€æœ‰æ¬„ä½
            const products = [];
            const seenProducts = new Set(); // ç”¨æ–¼å»é‡

            for (let row of data) {
                for (let cell of row) {
                    if (cell === 'å“å') continue; // è·³éæ¨™é¡Œ
                    const parsedItems = parseOrangePointCell(String(cell));
                    // parseOrangePointCell ç¾åœ¨è¿”å›æ•¸çµ„
                    for (const parsed of parsedItems) {
                        // å‰µå»ºå”¯ä¸€éµä»¥å»é‡ï¼ˆå•†å“åç¨± + æ•¸é‡ï¼‰
                        const key = `${parsed.name}|${parsed.quantity}`;
                        if (!seenProducts.has(key)) {
                            seenProducts.add(key);
                            products.push({
                                raw: cell,
                                ...parsed
                            });
                        }
                    }
                }
            }

            // åŸ·è¡Œæ˜ å°„
            const results = products.map(p => ({
                ...p,
                ...autoMapProductOrangePoint(p.name, p.quantity)
            }));

            // çµ±è¨ˆ
            const total = results.length;
            const mapped = results.filter(r => r.templateProduct).length;
            const filtered = products.length - results.length;

            document.getElementById('stats').style.display = 'block';
            document.getElementById('stats').innerHTML = `
                <strong>ğŸ“Š çµ±è¨ˆï¼š</strong>
                ç¸½è¨ˆ ${total} é … | 
                <span class="success">æˆåŠŸæ˜ å°„ ${mapped} é …</span> | 
                <span class="warning">æœªè­˜åˆ¥ ${total - mapped} é …</span>
            `;

            // é¡¯ç¤ºçµæœ
            document.getElementById('result').style.display = 'block';
            const tbody = document.getElementById('dataBody');
            tbody.innerHTML = '';

            results.forEach((r, i) => {
                const tr = document.createElement('tr');
                const confidence = Math.round((r.confidence || 0) * 100);
                const confidenceClass = confidence >= 90 ? 'success' : confidence >= 70 ? 'warning' : 'error';

                tr.innerHTML = `
                    <td>${i + 1}</td>
                    <td>${r.raw || ''}</td>
                    <td>${r.name || ''}</td>
                    <td>${r.quantity || ''}</td>
                    <td>${r.templateProduct || '<span class="error">âŒ æœªè­˜åˆ¥</span>'}</td>
                    <td>${r.templateColumn || '-'}</td>
                    <td>${r.templateSpec || '-'}</td>
                    <td>${r.mappedQuantity || '-'}</td>
                    <td class="${confidenceClass}">${confidence}%</td>
                `;
                tbody.appendChild(tr);
            });
        });
    </script>
</body>

</html>